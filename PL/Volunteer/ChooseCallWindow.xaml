<Window x:Class="PL.Volunteer.ChooseCallWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Choose Call to Handle" Height="600" Width="850"
        WindowStartupLocation="CenterScreen"
        DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}"
        Closed="Window_Closed">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Filters -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 0 0 10" Grid.Row="0">
            <TextBlock Text="סוג קריאה:" Margin="0 0 10 0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding CallTypes}" SelectedItem="{Binding SelectedCallType, Mode=TwoWay}" Width="150" Margin="0 0 20 0"/>
            <TextBlock Text="מיון לפי:" Margin="0 0 10 0" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding CallSortFields}" SelectedItem="{Binding SortField, Mode=TwoWay}" Width="150"/>
        </StackPanel>

        <!-- Address update -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 0 0 10" Grid.Row="1">
            <TextBlock Text="כתובת נוכחית:" VerticalAlignment="Center" Margin="0 0 10 0"/>
            <TextBox Text="{Binding VolunteerAddress, UpdateSourceTrigger=PropertyChanged}" Width="400"/>
            <Button Content="עדכן כתובת" Margin="10 0 0 0" Padding="10 5" Click="UpdateAddressButton_Click"/>
        </StackPanel>

        <!-- Calls grid -->
        <DataGrid ItemsSource="{Binding OpenCalls}" AutoGenerateColumns="False" IsReadOnly="True" SelectedItem="{Binding SelectedCall, Mode=TwoWay}" Grid.Row="2">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                <DataGridTextColumn Header="סוג קריאה" Binding="{Binding CallType}" Width="120"/>
                <DataGridTextColumn Header="כתובת" Binding="{Binding Address}" Width="200"/>
                <DataGridTextColumn Header="שעת פתיחה" Binding="{Binding OpeningTime}" Width="150"/>
                <DataGridTextColumn Header="מרחק" Binding="{Binding DistanceFromVolunteer}" Width="80"/>
                <DataGridTemplateColumn Header="בחר" Width="80">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="בחר" Click="AssignCall_Click"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Selected call description -->
        <TextBlock Grid.Row="3" Margin="0 10 0 0" TextWrapping="Wrap" Text="{Binding SelectedCall.VerbalDescription}" FontSize="14"/>
    </Grid>
</Window>
